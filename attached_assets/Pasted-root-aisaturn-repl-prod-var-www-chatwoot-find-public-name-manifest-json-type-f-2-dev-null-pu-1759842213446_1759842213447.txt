root@aisaturn-repl-prod:/var/www/chatwoot# find public -name "manifest*.json" -type f 2>/dev/null
public/manifest.json
public/packs/manifest.json
public/vite/.vite/manifest.json
public/vite/.vite/manifest-assets.json
root@aisaturn-repl-prod:/var/www/chatwoot# ls -lah public/vite/.vite/ 2>/dev/null | head -10
total 80K
drwxr-xr-x 2 root root 4.0K Oct  7 12:58 .
drwxr-xr-x 4 root root 4.0K Oct  7 12:58 ..
-rw-r--r-- 1 root root    2 Oct  7 12:58 manifest-assets.json
-rw-r--r-- 1 root root  68K Oct  7 12:58 manifest.json
root@aisaturn-repl-prod:/var/www/chatwoot# grep -r "saturn_agent_id" public/vite/assets/*.js 2>/dev/null | head -3
public/vite/assets/dashboard-B4mN9dUD.js:`)),Y$e(s,n??{})}const X$e=["innerHTML"],q$e=["title"],$T=Ko({__name:"Letter",props:{className:{},html:{},text:{},useIframe:{type:Boolean},iframeTitle:{},rewriteExternalLinks:{},rewriteExternalResources:{},allowedCssProperties:{},allowedSchemas:{},preserveCssPriority:{type:Boolean}},setup(e){const t=e,{className:n,html:s,text:a,useIframe:o,iframeTitle:i,rewriteExternalLinks:l,rewriteExternalResources:r,allowedSchemas:c,allowedCssProperties:u,preserveCssPriority:d}=On(t),h=K$e(s,a,{rewriteExternalResources:r,rewriteExternalLinks:l,allowedSchemas:c,preserveCssPriority:d,allowedCssProperties:u}),f="data:text/html;charset=utf-8,"+encodeURIComponent(h);return(g,b)=>N(o)?N(o)?(m(),v("div",{key:1,class:ae([N(n)])},[p("iframe",{src:f,title:N(i)},null,8,q$e)],2)):$("",!0):(m(),v("div",{key:0,class:ae([N(n)]),innerHTML:N(h)},null,10,X$e))}}),Z$e=["azimuth","background","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-repeat-x","background-repeat-y","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","box-sizing","break-after","break-before","break-inside","caption-side","clear","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","direction","display","elevation","empty-cells","float","font","font-family","font-feature-settings","font-kerning","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-weight","height","image-orientation","image-resolution","ime-mode","isolation","layout-flow","layout-grid","layout-grid-char","layout-grid-char-spacing","layout-grid-line","layout-grid-mode","layout-grid-type","letter-spacing","line-break","line-height","list-style","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","max-height","max-width","min-height","min-width","mix-blend-mode","object-fit","object-position","opacity","outline","outline-color","outline-style","outline-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","pitch","pitch-range","quotes","richness","speak","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","table-layout","text-align","text-align-last","text-autospace","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-style","text-indent","text-justify","text-kashida-space","text-orientation","text-overflow","text-transform","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","unicode-bidi","vertical-align","voice-family","white-space","white-space-collapse","width","word-break","word-spacing","word-wrap","writing-mode","zoom"],MT=Z$e,LT=[".gmail_quote_container",".gmail_quote",".OutlookQuote",".email-quote",".quoted-text",".quote",'[class*="quote"]','[class*="Quote"]'],Q$e=[/On .* wrote:/i,/-----Original Message-----/i,/Sent: /i,/From: /i];class DT{static extractQuotes(t){const n=document.createElement("div");return n.innerHTML=t,LT.forEach(a=>{n.querySelectorAll(a).forEach(o=>{o.remove()})}),this.findTextNodeQuotes(n).forEach(a=>{a.remove()}),n.innerHTML}static hasQuotes(t){const n=document.createElement("div");n.innerHTML=t;for(const a of LT)if(n.querySelector(a))return!0;return this.findTextNodeQuotes(n).length>0}static findTextNodeQuotes(t){const n=[],s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1);for(let a=s.nextNode();a!==null;a=s.nextNode())if(Q$e.some(i=>i.test(a.textContent))){const i=this.findParentBlock(a);i&&!n.includes(i)&&n.push(i)}return n}static findParentBlock(t){const n=["DIV","P","BLOCKQUOTE","SECTION"];let s=t.parentElement;for(;s;){if(n.includes(s.tagName))return s;s=s.parentElement}return null}}const J$e={key:1},eMe={key:2},tMe={key:3},nMe={key:4},sMe={__name:"EmailMeta",setup(e){const{contentAttributes:t,status:n,sender:s}=Qn(),a=I(()=>n.value===bn.FAILED),o=I(()=>{var h,f;return((f=(h=t.value)==null?void 0:h.email)==null?void 0:f.from)??[]}),i=I(()=>{const{toEmails:h,email:f}=t.value;return(f==null?void 0:f.to)??h??[]}),l=I(()=>{var h,f,g;return((h=t.value)==null?void 0:h.ccEmails)??((g=(f=t.value)==null?void 0:f.email)==null?void 0:g.cc)??[]}),r=I(()=>{const h=o.value[0]??"",f=s.value.email??"";return!h&&!f?null:h===f?s.value.name:null}),c=I(()=>{var h,f,g;return((h=t.value)==null?void 0:h.bccEmails)??((g=(f=t.value)==null?void 0:f.email)==null?void 0:g.bcc)??[]}),u=I(()=>{var h,f;return((f=(h=t.value)==null?void 0:h.email)==null?void 0:f.subject)??""}),d=I(()=>o.value[0]||i.value.length||l.value.length||c.value.length||u.value);return(h,f)=>re((m(),v("section",{class:ae(["space-y-1 rtl:pl-9 ltr:pr-9 text-sm break-words",a.value?"text-n-ruby-11":"text-n-slate-11"])},[d.value?(m(),v(de,{key:0},[o.value[0]?(m(),v("div",{key:0,class:ae(a.value?"text-n-ruby-11":"text-n-slate-12")},[r.value?(m(),v(de,{key:0},[p("span",null,y(r.value),1),Re(" <"+y(o.value[0])+"> ",1)],64)):(m(),v(de,{key:1},[Re(y(o.value[0]),1)],64))],2)):$("",!0),i.value.length?(m(),v("div",J$e,y(h.$t("EMAIL_HEADER.TO"))+": "+y(i.value.join(", ")),1)):$("",!0),l.value.length?(m(),v("div",eMe,y(h.$t("EMAIL_HEADER.CC"))+": "+y(l.value.join(", ")),1)):$("",!0),c.value.length?(m(),v("div",tMe,y(h.$t("EMAIL_HEADER.BCC"))+": "+y(c.value.join(", ")),1)):$("",!0),u.value?(m(),v("div",nMe,y(h.$t("EMAIL_HEADER.SUBJECT"))+": "+y(u.value),1)):$("",!0)],64)):$("",!0)],2)),[[rn,d.value]])}},aMe={key:1,class:"px-4 pb-4 space-y-2"},kT={__name:"Index",setup(e){const{content:t,contentAttributes:n,attachments:s,messageType:a}=Qn(),o=X(!1),i=X(!1),l=X(!1),r=X(!1),c=Cs("contentContainer");it(()=>{var x;o.value=((x=c.value)==null?void 0:x.scrollHeight)>400});const u=I(()=>a.value===ss.OUTGOING),d=I(()=>!u.value),{hasTranslations:h,translationContent:f}=iC(n),g=I(()=>{var w,k,L;const x=((L=(k=(w=n==null?void 0:n.value)==null?void 0:w.email)==null?void 0:k.textContent)==null?void 0:L.full)??t.value;return IR(x)}),b=I(()=>{var x,w,k;return((k=(w=(x=n==null?void 0:n.value)==null?void 0:x.email)==null?void 0:w.htmlContent)==null?void 0:k.full)||g.value}),A=I(()=>h.value&&!r.value?f.value:t.value),E=I(()=>h.value&&!r.value?f.value:g.value),S=I(()=>h.value&&!r.value?f.value:b.value),_=I(()=>DT.extractQuotes(S.value)),C=I(()=>DT.hasQuotes(S.value)),R=I(()=>r.value?"original":h.value?"translated":"original"),O=()=>{r.value=!r.value};return(x,w)=>(m(),D(Ga,{class:ae(["w-full",{"bg-n-slate-4":d.value,"bg-n-solid-blue":u.value}]),"data-bubble-name":"email"},{default:z(()=>[T(sMe,{class:ae(["p-3",{"border-b border-n-strong":d.value,"border-b border-n-slate-8/20":u.value}])},null,8,["class"]),p("section",{ref_key:"contentContainer",ref:c,class:"p-3"},[p("div",{class:ae({"max-h-[400px] overflow-hidden relative":!i.value&&o.value,"overflow-y-scroll relative":i.value})},[o.value&&!i.value?(m(),v("div",{key:0,class:ae(["absolute left-0 right-0 bottom-0 h-40 px-8 flex items-end",{"bg-gradient-to-t from-n-slate-4 via-n-slate-4 via-20% to-transparent":d.value,"bg-gradient-to-t from-n-solid-blue via-n-solid-blue via-20% to-transparent":u.value}])},[p("button",{class:"text-n-slate-12 py-2 px-8 mx-auto text-center flex items-center gap-2",onClick:w[0]||(w[0]=k=>i.value=!0)},[T(ht,{icon:"i-lucide-maximize-2"}),Re(" "+y(x.$t("EMAIL_HEADER.EXPAND")),1)])],2)):$("",!0),u.value&&N(t)?(m(),D(tC,{key:1,class:"text-n-slate-12",content:A.value},null,8,["content"])):(m(),v(de,{key:2},[l.value?(m(),D(N($T),{key:`letter-quoted-${R.value}`,"class-name":"prose prose-bubble !max-w-none letter-render","allowed-css-properties":[...N(MT),"transform","transform-origin"],html:S.value,text:E.value},null,8,["allowed-css-properties","html","text"])):(m(),D(N($T),{key:`letter-unquoted-${R.value}`,"class-name":"prose prose-bubble !max-w-none letter-render",html:_.value,"allowed-css-properties":[...N(MT),"transform","transform-origin"],text:E.value},null,8,["html","allowed-css-properties","text"]))],64)),C.value?(m(),v("button",{key:3,class:"text-n-slate-11 px-1 leading-none text-sm bg-n-alpha-black2 text-center flex items-center gap-1 mt-2",onClick:w[1]||(w[1]=k=>l.value=!l.value)},[l.value?(m(),v(de,{key:0},[Re(y(x.$t("CHAT_LIST.HIDE_QUOTED_TEXT")),1)],64)):(m(),v(de,{key:1},[Re(y(x.$t("CHAT_LIST.SHOW_QUOTED_TEXT")),1)],64)),T(ht,{icon:l.value?"i-lucide-chevron-up":"i-lucide-chevron-down"},null,8,["icon"])])):$("",!0)],2)],512),N(h)?(m(),D(oC,{key:0,class:"py-2 px-3","showing-original":r.value,onToggle:O},null,8,["showing-original"])):$("",!0),Array.isArray(N(s))&&N(s).length?(m(),v("section",aMe,[T(aC,{attachments:N(s),class:"gap-1"},null,8,["attachments"])])):$("",!0)]),_:1},8,["class"]))}},oMe={__name:"Unsupported",setup(e){return(t,n)=>(m(),D(Ga,{class:"px-4 py-3 text-sm","data-bubble-name":"unsupported"},{default:z(()=>[Re(y(t.$t("CONVERSATION.UNSUPPORTED_MESSAGE")),1)]),_:1}))}},iMe={__name:"Contact",setup(e){const{attachments:t}=Qn(),n=lt(),{t:s}=Ce(),a=I(()=>t.value[0]),o=I(()=>a.value.fallbackTitle),i=I(()=>{const{meta:g}=a.value??{},{firstName:b,lastName:A}=g??{};return`${b??""} ${A??""}`.trim()}),l=I(()=>o.value.replace(/\s|-|[A-Za-z]/g,"")),r=I(()=>o.value.replace(/\D/g,""));function c(){return{name:i.value,phone_number:`+${r.value}`}}async function u(g){const A={payload:[{attribute_key:"phone_number",filter_operator:"equal_to",values:[g],attribute_model:"standard",custom_attribute_type:""}]};return(await n.dispatch("contacts/filter",{queryPayload:A,resetState:!1})).shift()}function d(g){const A=`/app/accounts/${window.location.pathname.split("/")[3]}/contacts/${g}`;window.open(A,"_blank")}async function h(){try{let g=await u(r);g||(g=await n.dispatch("contacts/create",c()),te(s("CONTACT_FORM.SUCCESS_MESSAGE"))),d(g.id)}catch(g){g instanceof Xd?g.data.includes("phone_number")&&te(s("CONTACT_FORM.FORM.PHONE_NUMBER.DUPLICATE")):g instanceof Yc?te(g.data):te(s("CONTACT_FORM.ERROR_MESSAGE"))}}const f=I(()=>({label:s("CONVERSATION.SAVE_CONTACT"),onClick:h}));return(g,b)=>(m(),D(Yp,{icon:"i-teenyicons-user-circle-solid","icon-bg-color":"bg-[#D6409F]","sender-translation-key":"CONVERSATION.SHARED_ATTACHMENT.CONTACT",title:i.value,content:o.value,action:l.value?f.value:null},null,8,["title","content","action"]))}},lMe={key:0,class:"text-sm truncate text-n-slate-12"},rMe={key:1,class:"video-call--container"},cMe=["src"],uMe={key:2},dMe={__name:"Dyte",setup(e){const{content:t,sender:n,id:s}=Qn(),{t:a}=Ce(),o=X(!1),i=X(""),l=I(()=>eR(i.value)),r=async()=>{o.value=!0;try{const{data:{token:d}={}}=await II.addParticipantToMeeting(s.value);i.value=d}catch{te(a("INTEGRATION_SETTINGS.DYTE.JOIN_ERROR"))}finally{o.value=!1}},c=()=>{i.value=""},u=I(()=>({label:a("INTEGRATION_SETTINGS.DYTE.CLICK_HERE_TO_JOIN"),onClick:r}));return(d,h)=>(m(),D(Yp,{icon:"i-ph-video-camera-fill","icon-bg-color":"bg-[#2781F6]","sender-translation-key":"CONVERSATION.SHARED_ATTACHMENT.MEETING",action:u.value},{default:z(()=>[N(n)?$("",!0):(m(),v("div",lMe,y(N(t)),1)),i.value?(m(),v("div",rMe,[p("iframe",{src:l.value,allow:"camera;microphone;fullscreen;display-capture;picture-in-picture;clipboard-write;"},null,8,cMe),p("button",{class:"px-4 py-2 text-sm rounded-lg bg-n-solid-3 mt-3",onClick:c},y(d.$t("INTEGRATION_SETTINGS.DYTE.LEAVE_THE_ROOM")),1)])):(m(),v("div",uMe,y("")))]),_:1},8,["action"]))}},pMe={__name:"Location",setup(e){const{attachments:t}=Qn(),{t:n}=Ce(),s=I(()=>t.value[0]),a=I(()=>s.value.coordinatesLat),o=I(()=>s.value.coordinatesLong),i=I(()=>s.value.fallbackTitle??s.value.fallback_title),l=I(()=>`https://maps.google.com/?q=${a.value},${o.value}`);return(r,c)=>(m(),D(Yp,{icon:"i-ph-navigation-arrow-fill","icon-bg-color":"bg-[#0D9B8A]","sender-translation-key":"CONVERSATION.SHARED_ATTACHMENT.LOCATION",content:i.value,action:{label:N(n)("COMPONENTS.LOCATION_BUBBLE.SEE_ON_MAP"),href:l.value}},null,8,["content","action"]))}},mMe={key:0,class:"mt-4"},hMe={class:"text-n-slate-11 italic"},fMe={key:0},gMe={key:1,class:"flex mt-1"},_Me={key:2,class:"text-n-slate-11 italic mt-2"},vMe={__name:"CSAT",setup(e){const{contentAttributes:t,content:n}=Qn(),{t:s}=Ce(),a=I(()=>{var u,d;return((d=(u=t.value)==null?void 0:u.submittedValues)==null?void 0:d.csatSurveyResponse)??{}}),o=I(()=>!!a.value.rating),i=I(()=>{var u;return((u=t.value)==null?void 0:u.displayType)||Ni.EMOJI}),l=I(()=>i.value===Ni.STAR),r=I(()=>o.value?rl.find(u=>u.value===a.value.rating):null),c=I(()=>a.value.rating||0);return(u,d)=>(m(),D(Ga,{class:"px-4 py-3","data-bubble-name":"csat"},{default:z(()=>[p("h4",null,y(N(n)||N(s)("CONVERSATION.CSAT_REPLY_MESSAGE")),1),o.value?(m(),v("dl",mMe,[p("dt",hMe,y(N(s)("CONVERSATION.RATING_TITLE")),1),l.value?(m(),v("dd",gMe,[(m(),v(de,null,Se(5,h=>p("span",{key:h,class:"text-2xl mr-1"},[p("i",{class:ae([h<=c.value?"i-ri-star-fill text-n-amber-9":"i-ri-star-line text-n-slate-10"])},null,2)])),64))])):(m(),v("dd",fMe,y(N(s)(r.value.translationKey)),1)),a.value.feedbackMessage?(m(),v("dt",_Me,y(N(s)("CONVERSATION.FEEDBACK_TITLE")),1)):$("",!0),p("dd",null,y(a.value.feedbackMessage),1)])):$("",!0)]),_:1}))}},EMe=["title"],bMe={key:0,class:"mt-4"},TMe={class:"text-n-slate-11 italic mt-2"},SMe={key:1,class:"my-2 font-medium"},AMe={__name:"Form",setup(e){const{content:t,contentAttributes:n,contentType:s}=Qn(),{t:a}=Ce(),{isAWebWidgetInbox:o}=Sp(),i=I(()=>{var l;if(s.value===ja.FORM){const{items:r,submittedValues:c=[]}=n.value;return c.length?c.map(u=>{const d=r.find(h=>h.name===u.name);return{title:u.value,value:u.value,label:d==null?void 0:d.label}}):[]}if(s.value===ja.INPUT_SELECT){const[r]=((l=n.value)==null?void 0:l.submittedValues)??[];return r?[{title:r.title,value:r.value,label:""}]:[]}return[]});return(l,r)=>{const c=Je("dompurify-html");return m(),D(Ga,{class:"px-4 py-3","data-bubble-name":"csat"},{default:z(()=>[re(p("span",{title:N(t)},null,8,EMe),[[c,N(t)]]),i.value.length?(m(),v("dl",bMe,[(m(!0),v(de,null,Se(i.value,u=>(m(),v(de,{key:u.title},[p("dt",TMe,y(u.label||N(a)("CONVERSATION.RESPONSE")),1),p("dd",null,y(u.title),1)],64))),128))])):N(o)?(m(),v("div",SMe,y(N(a)("CONVERSATION.NO_RESPONSE")),1)):$("",!0)]),_:1})}}},yMe={class:"flex gap-3 items-center p-3 w-full"},IMe={class:"flex overflow-hidden flex-col flex-grow"},CMe={class:"text-base font-medium truncate"},NMe={class:"text-xs text-slate-500"},OMe={__name:"VoiceCall",setup(e){const{contentAttributes:t}=Qn(),n=I(()=>{var u;return(u=t.value)==null?void 0:u.data}),s=I(()=>{var u;return(u=n.value)==null?void 0:u.status}),a=I(()=>{var u;return(u=n.value)==null?void 0:u.call_direction}),{labelKey:o,subtextKey:i,bubbleIconBg:l,bubbleIconName:r}=gI(s,a),c=I(()=>s.value==="ringing"?"ring-1 ring-emerald-300":"");return(u,d)=>(m(),D(Ga,{class:"p-0 border-none","hide-meta":""},{default:z(()=>[p("div",{class:ae(["flex overflow-hidden flex-col w-full max-w-xs bg-white rounded-lg border border-slate-100 text-slate-900 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-100",c.value])},[p("div",yMe,[p("div",{class:ae(["flex justify-center items-center rounded-full size-10 shrink-0",N(l)])},[p("span",{class:ae(["text-xl",N(r)])},null,2)],2),p("div",IMe,[p("span",CMe,y(u.$t(N(o))),1),p("span",NMe,y(u.$t(N(i))),1)])])],2)]),_:1}))}},RMe={class:"text-xs text-n-ruby-11 flex items-center gap-1.5"},xMe={class:"relative group"},wMe={class:"bg-n-alpha-2 rounded-md size-5 grid place-content-center cursor-pointer"},$Me=["disabled"],MMe={__name:"MessageError",props:{error:{type:String,required:!0}},emits:["retry"],setup(e,{emit:t}){const n=t,{orientation:s,status:a,createdAt:o}=Qn(),{t:i}=Ce(),l=I(()=>!tR(o.value));return(r,c)=>(m(),v("div",RMe,[p("span",null,y(N(i)("CHAT_LIST.FAILED_TO_SEND")),1),p("div",xMe,[p("div",wMe,[T(ht,{icon:"i-lucide-alert-triangle",class:"text-n-ruby-11 size-[14px]"})]),p("div",{class:ae(["absolute bg-n-alpha-3 px-4 py-3 border rounded-xl border-n-strong text-n-slate-12 bottom-6 w-52 text-xs backdrop-blur-[100px] shadow-[0px_0px_24px_0px_rgba(0,0,0,0.12)] opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all break-all",{"ltr:left-0 rtl:right-0":N(s)===N(rs).LEFT,"ltr:right-0 rtl:left-0":N(s)===N(rs).RIGHT}])},y(e.error),3)]),l.value?(m(),v("button",{key:0,type:"button",disabled:N(a)!==N(bn).FAILED,class:"bg-n-alpha-2 rounded-md size-5 grid place-content-center cursor-pointer",onClick:c[0]||(c[0]=u=>n("retry"))},[T(ht,{icon:"i-lucide-refresh-ccw",class:"text-n-ruby-11 size-[14px]"})],8,$Me)):$("",!0)]))}},LMe={components:{AddCannedModal:vA,MenuItem:V_,ContextMenu:H_,NextButton:ee},props:{message:{type:Object,required:!0},isOpen:{type:Boolean,default:!1},enabledOptions:{type:Object,default:()=>({})},contextMenuPosition:{type:Object,default:()=>({})},hideButton:{type:Boolean,default:!1}},emits:["open","close","replyTo"],setup(){const{getPlainText:e}=va();return{getPlainText:e}},data(){return{isCannedResponseModalOpen:!1,showDeleteModal:!1}},computed:{...pt({getAccount:"accounts/getAccount",currentAccountId:"getCurrentAccountId"}),plainTextContent(){return this.getPlainText(this.messageContent)},conversationId(){return this.message.conversation_id??this.message.conversationId},messageId(){return this.message.id},messageContent(){return this.message.content},contentAttributes(){return bs(this.message.content_attributes??this.message.contentAttributes)}},methods:{async copyLinkToMessage(){const e=window.chatwootConfig.hostURL+Tt(dg({id:this.conversationId,accountId:this.currentAccountId}));await ga(`${e}?messageId=${this.messageId}`),te(this.$t("CONVERSATION.CONTEXT_MENU.LINK_COPIED")),this.handleClose()},async handleCopy(){await ga(this.plainTextContent),te(this.$t("CONTACT_PANEL.COPY_SUCCESSFUL")),this.handleClose()},showCannedResponseModal(){Yt(gd.ADDED_TO_CANNED_RESPONSE),this.isCannedResponseModalOpen=!0},hideCannedResponseModal(){this.isCannedResponseModalOpen=!1,this.handleClose()},handleOpen(e){this.$emit("open",e)},handleClose(e){this.$emit("close",e)},handleTranslate(){const{locale:e}=this.getAccount(this.currentAccountId);this.$store.dispatch("translateMessage",{conversationId:this.conversationId,messageId:this.messageId,targetLanguage:e||"en"}),Yt(ea.TRANSLATE_A_MESSAGE),this.handleClose()},handleReplyTo(){this.$emit("replyTo",this.message),this.handleClose()},openDeleteModal(){this.handleClose(),this.showDeleteModal=!0},async confirmDeletion(){try{await this.$store.dispatch("deleteMessage",{conversationId:this.conversationId,messageId:this.messageId}),te(this.$t("CONVERSATION.SUCCESS_DELETE_MESSAGE")),this.handleClose()}catch{te(this.$t("CONVERSATION.FAIL_DELETE_MESSSAGE"))}},closeDeleteModal(){this.showDeleteModal=!1}}},DMe={class:"context-menu"},kMe={class:"menu-container"},PMe={key:5};function BMe(e,t,n,s,a,o){const i=H("AddCannedModal"),l=H("woot-modal"),r=H("woot-delete-modal"),c=H("NextButton"),u=H("MenuItem"),d=H("ContextMenu");return m(),v("div",DMe,[a.isCannedResponseModalOpen&&n.enabledOptions.cannedResponse?(m(),D(l,{key:0,show:a.isCannedResponseModalOpen,"onUpdate:show":t[0]||(t[0]=h=>a.isCannedResponseModalOpen=h),"on-close":o.hideCannedResponseModal},{default:z(()=>[T(i,{"response-content":o.plainTextContent,"on-close":o.hideCannedResponseModal},null,8,["response-content","on-close"])]),_:1},8,["show","on-close"])):$("",!0),a.showDeleteModal&&n.enabledOptions.delete?(m(),D(r,{key:1,show:a.showDeleteModal,"onUpdate:show":t[1]||(t[1]=h=>a.showDeleteModal=h),class:"context-menu--delete-modal","on-close":o.closeDeleteModal,"on-confirm":o.confirmDeletion,title:e.$t("CONVERSATION.CONTEXT_MENU.DELETE_CONFIRMATION.TITLE"),message:e.$t("CONVERSATION.CONTEXT_MENU.DELETE_CONFIRMATION.MESSAGE"),"confirm-text":e.$t("CONVERSATION.CONTEXT_MENU.DELETE_CONFIRMATION.DELETE"),"reject-text":e.$t("CONVERSATION.CONTEXT_MENU.DELETE_CONFIRMATION.CANCEL")},null,8,["show","on-close","on-confirm","title","message","confirm-text","reject-text"])):$("",!0),n.hideButton?$("",!0):(m(),D(c,{key:2,ghost:"",slate:"",sm:"",icon:"i-lucide-ellipsis-vertical",class:"invisible group-hover/context-menu:visible",onClick:o.handleOpen},null,8,["onClick"])),n.isOpen&&!a.isCannedResponseModalOpen?(m(),D(d,{key:3,x:n.contextMenuPosition.x,y:n.contextMenuPosition.y,onClose:o.handleClose},{default:z(()=>[p("div",kMe,[n.enabledOptions.replyTo?(m(),D(u,{key:0,option:{icon:"arrow-reply",label:e.$t("CONVERSATION.CONTEXT_MENU.REPLY_TO")},variant:"icon",onClick:Fe(o.handleReplyTo,["stop"])},null,8,["option","onClick"])):$("",!0),n.enabledOptions.copy?(m(),D(u,{key:1,option:{icon:"clipboard",label:e.$t("CONVERSATION.CONTEXT_MENU.COPY")},variant:"icon",onClick:Fe(o.handleCopy,["stop"])},null,8,["option","onClick"])):$("",!0),n.enabledOptions.translate?(m(),D(u,{key:2,option:{icon:"translate",label:e.$t("CONVERSATION.CONTEXT_MENU.TRANSLATE")},variant:"icon",onClick:Fe(o.handleTranslate,["stop"])},null,8,["option","onClick"])):$("",!0),t[2]||(t[2]=p("hr",null,null,-1)),n.enabledOptions.copyLink?(m(),D(u,{key:3,option:{icon:"link",label:e.$t("CONVERSATION.CONTEXT_MENU.COPY_PERMALINK")},variant:"icon",onClick:Fe(o.copyLinkToMessage,["stop"])},null,8,["option","onClick"])):$("",!0),n.enabledOptions.cannedResponse?(m(),D(u,{key:4,option:{icon:"comment-add",label:e.$t("CONVERSATION.CONTEXT_MENU.CREATE_A_CANNED_RESPONSE")},variant:"icon",onClick:Fe(o.showCannedResponseModal,["stop"])},null,8,["option","onClick"])):$("",!0),n.enabledOptions.delete?(m(),v("hr",PMe)):$("",!0),n.enabledOptions.delete?(m(),D(u,{key:6,option:{icon:"delete",label:e.$t("CONVERSATION.CONTEXT_MENU.DELETE")},variant:"icon",onClick:Fe(o.openDeleteModal,["stop"])},null,8,["option","onClick"])):$("",!0)])]),_:1},8,["x","y","onClose"])):$("",!0)])}const UMe=Le(LMe,[["render",BMe],["__scopeId","data-v-c14c8c4d"]]),FMe=["id","data-message-id"],GMe={key:0},VMe={key:0,class:"[grid-area:avatar] flex items-end"},HMe={key:0,class:"flex items-center justify-center rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex-shrink-0",style:{width:"24px",height:"24px",fontSize:"14px"}},WMe={key:2,class:"context-menu-wrap"},zMe={__name:"Message",props:{id:{type:Number,required:!0},messageType:{type:Number,required:!0,validator:e=>Object.values(ss).includes(e)},status:{type:String,required:!0,validator:e=>Object.values(bn).includes(e)},attachments:{type:Array,default:()=>[]},content:{type:String,default:null},contentAttributes:{type:Object,default:()=>({})},contentType:{type:String,default:"text",validator:e=>Object.values(ja).includes(e)},conversationId:{type:Number,required:!0},createdAt:{type:Number,required:!0},currentUserId:{type:Number,required:!0},groupWithNext:{type:Boolean,default:!1},inboxId:{type:Number,default:null},inboxSupportsReplyTo:{type:Object,default:()=>({})},inReplyTo:{type:Object,default:null},isEmailInbox:{type:Boolean,default:!1},private:{type:Boolean,default:!1},sender:{type:Object,default:null},senderId:{type:Number,default:null},senderType:{type:String,default:null},sourceId:{type:String,default:""}},emits:["retry"],setup(e,{emit:t}){const n=e,s=t,a=X({}),o=X(!1),i=X(!1),{t:l}=Ce(),r=Pt(),c=I(()=>{var F;return n.private?Cn.PRIVATE:n.isEmailInbox&&[ss.INCOMING,ss.OUTGOING].includes(n.messageType)||n.contentType===ja.INCOMING_EMAIL?Cn.EMAIL:n.status===bn.FAILED?Cn.ERROR:(F=n.contentAttributes)!=null&&F.isUnsupported?Cn.UNSUPPORTED:(!n.sender||n.sender.type===Vl.AGENT_BOT)&&n.messageType===ss.OUTGOING?Cn.BOT:{[ss.INCOMING]:Cn.USER,[ss.ACTIVITY]:Cn.ACTIVITY,[ss.OUTGOING]:Cn.AGENT,[ss.TEMPLATE]:Cn.TEMPLATE}[n.messageType]||Cn.USER}),u=I(()=>{var F,B,K;if((F=n.contentAttributes)!=null&&F.saturn_agent_id)return!0;if(n.messageType===ss.ACTIVITY)return!1;if(n.status===bn.PROGRESS&&n.messageType===ss.OUTGOING)return!0;const M=n.senderId??((B=n.sender)==null?void 0:B.id),U=((K=n.sender)==null?void 0:K.type)??n.senderType;return!U||!M||[Vl.AGENT_BOT,Vl.CAPTAIN_ASSISTANT].includes(U)?!0:U.toLowerCase()===Vl.USER.toLowerCase()}),d=I(()=>u.value?rs.RIGHT:n.messageType===ss.ACTIVITY?rs.CENTER:rs.LEFT),h=I(()=>({[rs.LEFT]:"justify-start",[rs.RIGHT]:"justify-end",[rs.CENTER]:"justify-center"})[d.value]),f=I(()=>({[rs.LEFT]:"grid grid-cols-1fr",[rs.RIGHT]:"grid grid-cols-[1fr_24px]"})[d.value]),g=I(()=>({[rs.LEFT]:`
root@aisaturn-repl-prod:/var/www/chatwoot# 
